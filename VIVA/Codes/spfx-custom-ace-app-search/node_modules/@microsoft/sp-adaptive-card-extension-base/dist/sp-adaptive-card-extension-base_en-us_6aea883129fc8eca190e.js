define("eeec822e-c28a-46b4-affc-7058e4c1aa80_1.16.1",["tslib","@microsoft/sp-http-base","@ms/sp-telemetry","@microsoft/sp-component-base","@microsoft/sp-loader","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-diagnostics"],function(n,a,i,r,o,s,c,d,l){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({"17wl":function(e,t){e.exports=n},"2SXB":function(e,t){e.exports=a},"2q6Q":function(e,t){e.exports=i},"7Awa":function(e,t){e.exports=r},I6O9:function(e,t){e.exports=o},Pk8u:function(e,t){e.exports=s},UWqr:function(e,t){e.exports=c},"X+PM":function(e,t){e.exports=d},mGD9:function(e){e.exports=JSON.parse('{"t":"Action Id: \\u0027{0}\\u0027 target URL should not be undefined or empty string. ","e":"Adaptive card extension icon."}')},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"_AdaptiveCardExtensionActionShim",function(){return i}),n.d(t,"AdaptiveCardExtensionContext",function(){return s}),n.d(t,"_AdaptiveCardExtensionHost",function(){return c}),n.d(t,"_AdaptiveCardExtensionLoader",function(){return I}),n.d(t,"BaseAdaptiveCardExtension",function(){return ae}),n.d(t,"_BaseAdaptiveCardExtensionCache",function(){return te}),n.d(t,"_LocalStorageACECache",function(){return ne}),n.d(t,"_isAdaptiveCardExtensionLKGCachingEnabled",function(){return M}),n.d(t,"MediaType",function(){return P}),n.d(t,"_IsolatedAdaptiveCardExtensionService",function(){return oe}),n.d(t,"BaseView",function(){return K}),n.d(t,"BaseBasicCardView",function(){return q}),n.d(t,"BaseCardView",function(){return W}),n.d(t,"BaseImageCardView",function(){return se}),n.d(t,"BasePrimaryTextCardView",function(){return ce}),n.d(t,"QuickViewNavigator",function(){return ee}),n.d(t,"ViewNavigator",function(){return $}),n.d(t,"BaseAdaptiveCardView",function(){return Y}),n.d(t,"_ACEMySiteCacheManager",function(){return de});var a=n("ut3N"),i=function(){function e(e,t){var n=this;this._ace=e,this._provider=t,this.handleAction=function(e){switch(e.getJsonTypeName()){case"Action.OpenUrl":n._handleOpenUrl(e);break;case"Action.ShowCard":n._handleShowCard(e);break;case"Action.Submit":n._handleSubmit(e);break;case"VivaAction.GetLocation":n._handleGetLocation(e);break;case"VivaAction.SelectMedia":n._handleSelectMedia(e);break;case"VivaAction.ShowLocation":n._handleShowLocation(e)}}}return e.prototype._handleGetLocation=function(e){var t,n=new a._QosMonitor("AdaptiveCardExtension._onExecuteAction.GetLocation",!0);try{var i={chooseLocationOnMap:null===(t=e.parameters)||void 0===t?void 0:t.chooseLocationOnMap};this._provider.getLocation(this._ace).getLocation(i),n.writeSuccess(),this._provider.log(this._ace,"VivaAction.GetLocation")}catch(e){n.writeUnexpectedFailure(void 0,e)}},e.prototype._handleOpenUrl=function(e){var t=e.url;t&&(this._provider.openUrl(this._ace,t),this._provider.log(this._ace,"OpenUrl"))},e.prototype._handleSelectMedia=function(e){this._provider.selectMedia(this._ace,e).getMedia(e),this._provider.log(this._ace,"VivaAction.SelectMedia")},e.prototype._handleShowCard=function(e){var t={id:e.id,type:"ShowCard"};this._provider.aceActionHandler(this._ace,t),this._provider.log(this._ace,"ShowCard")},e.prototype._handleShowLocation=function(e){var t,n=new a._QosMonitor("AdaptiveCardExtension._onExecuteAction.ShowLocation",!0);try{var i={locationCoordinates:null===(t=e.parameters)||void 0===t?void 0:t.locationCoordinates};this._provider.showLocation(this._ace).showLocation(i),n.writeSuccess(),this._provider.log(this._ace,"VivaAction.ShowLocation")}catch(e){n.writeUnexpectedFailure(void 0,e)}},e.prototype._handleSubmit=function(e){var t,n=this,i=new a._QosMonitor("AdaptiveCardExtension._onExecuteAction.handleConfirmationDialog",!0),r=null===(t=e.data)||void 0===t?void 0:t._internalQuickViewId;if(r)this._provider.quickView(r);else{var o={data:e.data,id:e.id,type:"Submit"};this._provider.confirmationDialog(o).then(function(e){i.writeSuccess(),e||(n._provider.aceActionHandler(n._ace,o),n._provider.log(n._ace,"Submit"))}).catch(function(){i.writeUnexpectedFailure()})}},e}(),r=n("17wl"),o=n("7Awa"),s=function(e){function t(t){var n=e.call(this,t)||this;return n._aceHost=t.host,n.manifest=t.manifest,n._deviceContext=t.deviceContext,n._location=t.location,n._logACEEditCustomerPromiseFailure=t.logEditCustomerPromiseFailure,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"_host",{get:function(){return this._aceHost},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propertyPane",{get:function(){return this._host.propertyPane},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceContext",{get:function(){return this._deviceContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"location",{get:function(){return this._location()},enumerable:!1,configurable:!0}),t.prototype._logEditCustomerPromiseFailure=function(e,t,n){this._logACEEditCustomerPromiseFailure&&this._logACEEditCustomerPromiseFailure(e,t,n)},t}(o.BaseComponentContext),c=function(){function e(e){this._onBeforeInitializedCallback=e.onBeforeInitializedCallback,this._onUpdateCallback=e.onUpdateCallback,this._onErrorCallback=e.onError,this._onRequestRenderTypeCallback=e.onRequestRenderTypeCallback,this._onVisibilityChanged=e.onVisibilityChanged,this._onRenderCompleted=e.onRenderCompleted,this._cache=e.cache,this.propertyPane=e.propertyPane}return e.prototype.update=function(e){this._onUpdateCallback(e)},e.prototype.onBeforeInitialized=function(e){this._onBeforeInitializedCallback&&this._onBeforeInitializedCallback(e)},e.prototype.onError=function(e){this._onErrorCallback&&this._onErrorCallback(e)},e.prototype.requestRenderTypeChange=function(e,t){this._onRequestRenderTypeCallback(e,t)},Object.defineProperty(e.prototype,"cache",{get:function(){return this._cache},enumerable:!1,configurable:!0}),e.prototype.onVisibilityChanged=function(e){this._onVisibilityChanged(e)},e.prototype.onRenderCompleted=function(e,t){this._onRenderCompleted&&this._onRenderCompleted(e,t)},e}(),d=n("I6O9"),l=n("UWqr"),u=n("2q6Q");function f(){return l._SPKillSwitch.isActivated("6836bc4c-8a69-4ed9-92c0-0d6187f3acb6")}function p(){return l._SPKillSwitch.isActivated("5533d556-60de-40a4-ab2e-ff72e237d89e")}function m(){return l._SPKillSwitch.isActivated("a95479e5-e6fb-4025-855c-a344a22d7466")}function _(){return l._SPKillSwitch.isActivated("e8daf7db-132e-4225-93a4-70cc5fc06bb9")}function h(){return l._SPKillSwitch.isActivated("8294236d-a9b6-40f5-8b23-508d3e66cd4b")}function b(){return l._SPKillSwitch.isActivated("0dd7591f-41e0-495b-8daf-aa2ca07d532c")}function g(){return l._SPKillSwitch.isActivated("b84986e1-7b26-45fd-b1e0-32a1ca76baaf")}function v(){return l._SPKillSwitch.isActivated("efd2e18b-64bb-439c-bf8f-704e66012f8f")}function y(){return l._SPKillSwitch.isActivated("48f94782-fac4-45a2-b9a3-49b1e5591c60")}var S="AdaptiveCardExtensionInitializationFailed",D="AdaptiveCardExtensionLoadFailed",I=function(){function e(){}return e._createQosExtraData=function(e){var t=e.aceData,n=e.deviceContext,a=e.initialDisplayMode,i=e.manifest;return{alias:i.alias,deviceContext:n,displayMode:b()?void 0:a,isInternal:i.isInternal,instanceId:!v()&&t.instanceIdForLogs?t.instanceIdForLogs:t.instanceId,manifestId:i.id,mpnId:i.mpnId,scenarioId:l._SPKillSwitch.isActivated("b544c716-bfa4-4bbb-a8df-237a8ecf2e47")?void 0:u._PerformanceLogger.getScenarioId(),storeAppId:i.storeAppId,teamsHosted:l._BrowserUtilities.isTeamsHosted()}},e.prototype.load=function(t){var n,i,r=this,o=new a._QosMonitor("AdaptiveCardExtension.Load",!0,!0),s=e._createQosExtraData(t),c="WebPart.ACE_".concat(t.manifest.alias,".").concat(t.manifest.isInternal?"internal":"external",".").concat(t.instanceId);return u._PerformanceLogger.startMarkForComponent(c),d.SPComponentLoader.loadComponent(t.manifest).then(function(e){return e.default&&(e=e.default),u._PerformanceLogger.markComponentModuleLoaded(c),new e}).catch(function(e){throw!g()&&t.manifest.isInternal&&t.initialDisplayMode===l.DisplayMode.Edit&&t.logEditCustomerPromiseFailure&&t.logEditCustomerPromiseFailure(t.manifest.alias,e.message,D),u._PerformanceLogger.endFailureForComponent(c,D,e),o.writeUnexpectedFailure(D,e,s),n=e,e}).then(function(e){var n,a=t.cacheObject?{state:(n=t.cacheObject).cachedState,cardNavigatorState:n.cardNavigatorState}:void 0;return(i=e)._internalInitialize(r._getContext(t),t.addedFromPersistedData,t.initialDisplayMode,c,!h()&&!!a),i._internalDeserialize(t.aceData),t.host.onBeforeInitialized(i),i.onInit(a)}).then(function(){return u._PerformanceLogger.markComponent(c,"init"),o.writeSuccess(s),i._internalOnAfterInit(),i}).catch(function(e){throw n||(!g()&&t.manifest.isInternal&&t.initialDisplayMode===l.DisplayMode.Edit&&t.logEditCustomerPromiseFailure&&t.logEditCustomerPromiseFailure(t.manifest.alias,e.message,S),u._PerformanceLogger.endFailureForComponent(c,S,e),o.writeUnexpectedFailure(S,e,s)),e})},e.prototype._getContext=function(e){return new s({host:e.host,manifest:e.manifest,instanceId:e.instanceId,parentServiceScope:e.serviceScope,loggingTag:"",deviceContext:e.deviceContext,location:e.location,logEditCustomerPromiseFailure:e.logEditCustomerPromiseFailure})},e}(),x=n("Pk8u"),C=n("mGD9"),O=new RegExp(/(?=.+)(\/l\/entity\/.+)/gi),w={Medium:1,Large:2};function E(e,t,n,a,i){var r,o;if("Submit"===t.type)(o=t).confirmationDialog&&(o.parameters||(o.parameters={}),o.parameters.__MSConfirmationDialog__=o.confirmationDialog),r={id:n,type:"Action.Submit",style:i,title:a,data:t.parameters||void 0};else if("ExternalLink"===t.type){A(t.parameters,e);var s=t.parameters.target;if(!s||""===s)throw new Error(l.Text.format(C.t,n));r={id:n,type:"Action.OpenUrl",style:i,title:a,url:s}}else"QuickView"===t.type?r={id:n,type:"Action.Submit",style:i,title:a,data:{_internalQuickViewId:t.parameters.view}}:"VivaAction.SelectMedia"===t.type?r={id:n,type:"VivaAction.SelectMedia",style:i,title:a,parameters:t.parameters}:"VivaAction.GetLocation"===t.type?r={id:n,type:"VivaAction.GetLocation",style:i,title:a,parameters:t.parameters}:"VivaAction.ShowLocation"===t.type&&(r={id:n,type:"VivaAction.ShowLocation",style:i,title:a,parameters:t.parameters});return r}function A(e,t){if(e&&e.isTeamsDeepLink&&function(e){return"Mobile"!==e}(t)){var n=e.target.match(O);n&&n[0]&&(e.target="msteams:".concat(n[0]))}}function L(e,t,n,a,i,o){var s,c=e.cardButtons,d=e.data,u=e.onCardSelection,f=e._templateType;if(a||(a=e.template),void 0===c||"Image"===f&&"Large"!==t||function(e,t,n,a){for(var i=[],r=Math.min(w[n],(null==t?void 0:t.length)||0),o=0;o<r;o++){var s=t[o],c=s.id?s.id:"ac-button-".concat(o);i.push(E(a,s.action,c,s.title,s.style))}e.actions=i}(a,c,t,n),u){var p=E(n,u,"select-action");"Action.OpenUrl"!==p.type&&"Action.Submit"!==p.type&&"VivaAction.GetLocation"!==p.type&&"VivaAction.ShowLocation"!==p.type&&"VivaAction.SelectMedia"!==p.type||(s=p)}return l._SPKillSwitch.isActivated("1d4ffc6d-4e10-4b40-9c83-7bd473380479")||"Image"!==e._templateType||void 0!==d.imageAltText||(d.imageAltText=""),{data:Object(r.__assign)({selectAction:s,iconProperty:i,iconAltText:d.iconAltText||C.e,title:o},d),template:a,cardProperties:{iconProperty:d.iconProperty||i,size:t,title:d.title||o,templateType:f}}}var k=function(){function e(e,t,n,a,i,o){this._context=e,this._getCardSize=t,this._getIconProperty=n,this._getTitle=a,this._handleInitializeCallback=i,this._settings=Object(r.__assign)(Object(r.__assign)({},this._defaultCacheSettings()),o)}return e.prototype.save=function(e,t,n,a,i,r){var o,s;if(this._settings.isEnabled){var c=this._initializeCustomCardView();if(c&&c.isCacheEnabled||!c&&n.isCacheEnabled){var d=c?L(c,this._getCardSize(),this._context.deviceContext,void 0,this._getIconProperty(),this._getTitle()):a.card;s=this._createCacheObject(a,d,i,r),null===(o=this._context._host.cache)||void 0===o||o.save(e,t,s)}}return s},e.prototype._createCacheObject=function(e,t,n,a){return{cachedCard:t,cardNavigatorState:n,isVisible:e.isVisible,cachedState:a,expirationTime:(new Date).getTime()+1e3*this._settings.expiryTimeInSeconds}},e.prototype._initializeCustomCardView=function(){if(this._settings.cachedCardView){var e=this._settings.cachedCardView();return this._handleInitializeCallback(e),e}},e.prototype._defaultCacheSettings=function(){return{isEnabled:!0,expiryTimeInSeconds:e.CACHE_EXPIRATION_TIME,cachedCardView:void 0}},e.CACHE_EXPIRATION_TIME=864e3,e}();function M(){return l._SPFlight.isEnabled(60456)}var P,T="auto",U={type:"TextBlock",subType:"Primary",text:"${primaryText}",weight:"Bolder",maxLines:1,spacing:"none"},F={type:"TextBlock",subType:"BodySecondary",text:"${description}",spacing:"none",wrap:!0},H={type:"TextBlock",subType:"BodyPrimary",text:"${primaryText}",spacing:"none",wrap:!0},R={type:"TextBlock",subType:"Title",text:"${title}",wrap:!1,maxLines:1,spacing:"none"},N={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",items:[{type:"ColumnSet",columns:[{type:"Column",spacing:"none",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:T},{type:"Column",spacing:"none",items:[R],width:"stretch"}]},H]}]},B={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",items:[{type:"Image",url:"${imageUrl}",altText:"${imageAltText}"},{type:"ColumnSet",spacing:"none",columns:[{type:"Column",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:T},{type:"Column",spacing:"none",items:[R],width:"stretch"}]},H]}]},j={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",items:[{type:"ColumnSet",columns:[{type:"Column",spacing:"none",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:T},{type:"Column",spacing:"none",items:[R],width:"stretch"}]},{type:"Container",spacing:"none",items:[U,F]}]}]},V={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",selectAction:"${selectAction}",items:[{type:"ColumnSet",columns:[{type:"Column",spacing:"none",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:T},{type:"Column",spacing:"none",items:[R],width:"stretch"}]},H]}]},z={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",selectAction:"${selectAction}",items:[{type:"Image",url:"${imageUrl}",altText:"${imageAltText}"},{type:"ColumnSet",spacing:"none",columns:[{type:"Column",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:T},{type:"Column",spacing:"none",items:[R],width:"stretch"}]},H]}]},G={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",selectAction:"${selectAction}",items:[{type:"ColumnSet",columns:[{type:"Column",spacing:"none",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:T},{type:"Column",spacing:"none",items:[R],width:"stretch"}]},{type:"Container",spacing:"none",items:[U,F]}]}]},K=function(){function e(){}return Object.defineProperty(e.prototype,"cardNavigator",{get:function(){return this._ace.cardNavigator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quickViewNavigator",{get:function(){return this._ace.quickViewNavigator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cardSize",{get:function(){return this._getCardSize()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),e.prototype.onAction=function(e){},e.prototype.onActionError=function(e){},e.prototype.setState=function(e){this._ace.setState(e)},e.prototype.setVisibility=function(e){this._ace.isVisible=e},e}(),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"cardButtons",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCardSelection",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCacheEnabled",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype._getTemplate=function(e,t){return Object(x.cloneDeep)(this.onCardSelection?t:e)},t}(K),q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._templateType="Basic",t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"template",{get:function(){return this._getTemplate(N,V)},enumerable:!1,configurable:!0}),t}(W),Q=function(e){function t(t){var n=e.call(this)||this;return n._primaryText=t,n._templateType="Basic",n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return{primaryText:this._primaryText}},enumerable:!1,configurable:!0}),t}(q),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"externalLink",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return""},enumerable:!1,configurable:!0}),t}(K),J=/\{(\d+)\}/g,X=function(){function e(){this._registeredCallbacks=new Map}return e.prototype.register=function(e,t){this._registeredCallbacks.has(e)||this._registeredCallbacks.set(e,t)},e.prototype.consume=function(e){var t=this._registeredCallbacks.get(e);if(!t)throw new Error(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(J,function(e,n){return null===t[n]?"":""+t[n]})}("View with id {0} must be registered before being used",e));return this._registeredCallbacks.delete(e),t},Object.defineProperty(e.prototype,"size",{get:function(){return this._registeredCallbacks.size},enumerable:!1,configurable:!0}),e}(),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"template",{get:function(){return{}},enumerable:!1,configurable:!0}),t}(Y),$=function(){function e(e,t){this._handleStackChangedCallback=e,this._handleInitializeCallback=t,this._viewStack=new Array,this._viewCache=new Map,this._viewRegistry=new X}return e.prototype.register=function(e,t){this._viewRegistry.register(e,t)},e.prototype.push=function(e,t){void 0===t&&(t=!1),this._push(e),this._handleStackChangedCallback(t)},e.prototype.replace=function(e,t){void 0===t&&(t=!1),this._pop(),this._push(e),this._handleStackChangedCallback(t)},e.prototype.pop=function(e){void 0===e&&(e=!1),this.size>1&&(this._pop(),this._handleStackChangedCallback(e))},Object.defineProperty(e.prototype,"size",{get:function(){return this._viewStack.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentId",{get:function(){var e=this.size;return e?this._viewStack[e-1]:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_currentView",{get:function(){return this._viewCache.get(this._viewStack[this.size-1])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewStack",{get:function(){return this._viewStack},enumerable:!1,configurable:!0}),e.prototype._clear=function(){this._viewStack=[]},e.prototype._forEach=function(e){this._viewCache.forEach(e)},e.prototype._getRegistrySize=function(){return this._viewRegistry.size},e.prototype._push=function(e){var t=this;if(void 0===this._viewCache.get(e)){var n=this._viewRegistry.consume(e)();!l._SPKillSwitch.isActivated("db1f6911-ac1f-42e4-890c-2c12bc4e2e00")&&n instanceof Promise?(n.then(function(n){t._handleInitializeCallback(n),t._viewCache.set(e,n),t._handleStackChangedCallback(!1)}).catch(function(e){console.error("could not load quickview",e)}),n=new Z):n=n,this._handleInitializeCallback(n),this._viewCache.set(e,n)}this._viewStack.push(e)},e.prototype._pop=function(){this._viewStack.pop()},e}(),ee=function(e){function t(t,n,a){var i=e.call(this,t,n)||this;return i._closeQuickViewCallback=a,i}return Object(r.__extends)(t,e),t.prototype.close=function(){this._closeQuickViewCallback()},t}($),te=function(){function e(){}return e.prototype.get=function(e,t){return this.getFromSource(e,t).then(function(e){if(e)return(new Date).getTime()<e.expirationTime?e:void 0})},e}(),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.getKey=function(e,t){return"AdaptiveCardExtension_LKG_".concat(e,"_").concat(t)},Object.defineProperty(t,"instance",{get:function(){return void 0===this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.save=function(e,t,n){var i=new a._QosMonitor("ACE.LocalStorage.save");try{var r=this._getLocalStorageEntry(e);r.set(t,n);var o=Array.from(r.entries());localStorage.setItem(e,JSON.stringify(o)),i.writeSuccess()}catch(e){var s=n.cachedCard.cardProperties.title||"";i.writeUnexpectedFailure("",e,{alias:s,instanceId:t})}},t.prototype.getFromSource=function(e,t){var n=new a._QosMonitor("ACE.LocalStorage.get");try{var i=this._getLocalStorageEntry(e).get(t);return i?n.writeSuccess():n.writeExpectedFailure("cacheMiss",void 0,{instanceId:t}),Promise.resolve(i)}catch(e){return n.writeUnexpectedFailure("",e,{instanceId:t}),Promise.resolve(void 0)}},t.prototype._getLocalStorageEntry=function(e){var t=localStorage.getItem(e);return t?new Map(JSON.parse(t)):new Map},t}(te),ae=function(e){function t(){var t=e.call(this)||this;return t._isLoggedRenderPerf=!1,t._isInitialized=!1,t._isInitializedWithLKG=!1,t._getCard=function(e){try{return L(t._cardNavigator._currentView,t.cardSize,t.context.deviceContext,e?t._ACRenderArgs.card.template:void 0,t.iconProperty,t.title)}catch(e){throw t.context._host.onError(e.toString()),e}},t._onViewInitialized=function(e){e._state=t.state,e._ace=t,e._properties=t.properties,e._getCardSize=function(){return t.cardSize},e._context=t.context},t._navigatorCallback=function(e){e||t.update(t._renderType)},t._closeQuickViewCallback=function(){t.context._host.requestRenderTypeChange("Card",t.instanceId)},t._cardSize="Medium",t._renderType="Card",t._isVisible=!0,t._urlParams=new URLSearchParams(window.location.search),t._cardNavigator=new $(t._navigatorCallback,t._onViewInitialized),t._quickViewNavigator=new ee(t._navigatorCallback,t._onViewInitialized,t._closeQuickViewCallback),t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"cardNavigator",{get:function(){return this._cardNavigator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cardSize",{get:function(){return this._cardSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataVersion",{get:function(){return l.Version.parse("1.0")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayMode",{get:function(){return this._displayMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quickViewNavigator",{get:function(){return this._quickViewNavigator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedFromPersistedData",{get:function(){return this._renderedFromPersistedData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedOnce",{get:function(){return this._renderedOnce},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderType",{get:function(){return this._renderType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){if(this._state)throw new Error("state can only be initialized once");this._state=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconProperty",{get:function(){return this._iconProperty},enumerable:!1,configurable:!0}),t.prototype.getPropertyPaneConfiguration=function(){return{pages:[]}},t.prototype.loadPropertyPaneResources=function(){return Promise.resolve()},t.prototype.getCacheSettings=function(){return{}},t.prototype.getCachedState=function(e){return{}},t.prototype._internalOnAction=function(e){this.navigator._currentView.onAction(e)},t.prototype._internalOnActionError=function(e){this.navigator._currentView.onActionError(e)},t.prototype.onBeforeSerialize=function(){},t.prototype.onAfterPropertiesUpdatedExternally=function(e){},t.prototype.onAfterDeserialize=function(e,t){return e},t.prototype.onDisplayModeChanged=function(e){},t.prototype.onDispose=function(){},t.prototype.onInit=function(e){return Promise.resolve()},t.prototype.onPropertyPaneFieldChanged=function(e,t,n){},t.prototype.onRenderTypeChanged=function(e){},t.prototype.renderCard=function(){},t.prototype._getPreFrameworkPropertyPaneConfiguration=function(){return[]},Object.defineProperty(t.prototype,"_isFrameworkPropertyPaneEnabled",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},set:function(e){this._isVisible=e,(y()||this._isInitialized)&&(this.cardNavigator._getRegistrySize()>0||this.cardNavigator._currentView)&&this.context._host.onVisibilityChanged(this._getRenderArguments(this.renderType))},enumerable:!1,configurable:!0}),t.prototype.renderCompleted=function(e){!h()&&this._renderCompletedPromiseResolver&&this._renderCompletedPromiseResolver(e)},t.prototype._endMarkForRenderComplete=function(e,t){var n=new a._QosMonitor("AdaptiveCardExtension.RenderCompleted");this._isLoggedRenderPerf||(e?t?u._PerformanceLogger.endFailureForComponent(this._perfTagName,"TimeOut"):u._PerformanceLogger.endMarkForComponent(this._perfTagName):u._PerformanceLogger.endMarkForComponentWithTimestamp(this._perfTagName,this._lkgRenderTime),this._isLoggedRenderPerf=!0);var i=o._WebPartLoadDataCollector.collect(this.context.manifest,this._perfTagName,this.context.pageContext),s=Object(r.__assign)(Object(r.__assign)({},i),{isInternal:this.manifest.isInternal||!1,isInitializedWithLKG:this._isInitializedWithLKG,didTimeOut:t,didUpdate:e,displayMode:b()?void 0:this.displayMode});t?n.writeUnexpectedFailure("",void 0,s):n.writeSuccess(s),this.context._host.onRenderCompleted(this.instanceId,e),this._clearRenderCompletedGuardTimer()},t.prototype._resolveRenderCompleted=function(){var e=this;this._renderCompletedPromise.then(function(t){e._endMarkForRenderComplete(t,!1)}).catch(function(){e._endMarkForRenderComplete(!0,!0)})},t.prototype.setState=function(e){if(!this._state)throw new Error("state must be initialized before calling setState");e&&(this._state=Object(r.__assign)(Object(r.__assign)({},this.state),Object(x.cloneDeep)(e)),this._cardNavigator._forEach(this._onViewInitialized),this._quickViewNavigator._forEach(this._onViewInitialized)),this._isInitialized&&this.context._host.update(this._getRenderArguments(this._renderType))},t.prototype.update=function(e,t){void 0===t&&(t=!1);var n=this._getRenderArguments(e,t);this.context._host.update(n)},t.prototype._getRenderArguments=function(e,t,n){var i,s=this;void 0===t&&(t=!1);var c=new a._QosMonitor("AdaptiveCardExtension.GetRenderArguments.".concat(e));try{if(!y()&&!this._isInitialized)throw new Error("".concat(this.context.manifest.alias," is not initialized"));if(this._setRenderType(e,n),"Card"===e&&0===this.cardNavigator.size){var d=this.renderCard();d||(d="_InternalDefaultCardView",this._cardNavigator.register(d,function(){return new Q(s.description)})),this._cardNavigator.push(d,!0)}if(void 0===this._ACRenderArgs?this._ACRenderArgs={card:"Card"===e?this._getCard(t):void 0,isVisible:this._isVisible,instanceId:this.instanceId,lastUpdatedType:e,quickLook:"QuickView"===e?this._getQuickView(t):void 0}:this._updateRenderArgs(e,t),M()&&(!l._SPKillSwitch.isActivated("b8c50ded-d048-4eb9-bc41-21190d9d3bbb")&&this.context.manifest.isolatedDomain||this.displayMode===l.DisplayMode.Read)&&"Card"===e){var f=null===(i=this._cacheManager)||void 0===i?void 0:i.save(this._cacheKey,this.instanceId,this._cardNavigator._currentView,this._ACRenderArgs,this.cardNavigator.viewStack,this.getCachedState(Object(r.__assign)({},this._state)));this._ACRenderArgs.cacheObject=f}var p=void 0;this._isLoggedRenderPerf||this.isRenderAsync||(u._PerformanceLogger.endMarkForComponent(this._perfTagName),p=o._WebPartLoadDataCollector.collect(this.context.manifest,this._perfTagName,this.context.pageContext),this._isLoggedRenderPerf=!0,h()||this.context._host.onRenderCompleted(this.instanceId,!0)),m()||(p=Object(r.__assign)(Object(r.__assign)({},p),{isInternal:this.manifest.isInternal||!1,displayMode:b()?void 0:this.displayMode})),c.writeSuccess(p)}catch(e){p=void 0,this._isLoggedRenderPerf||(u._PerformanceLogger.endFailureForComponent(this._perfTagName,"Render",e),p=o._WebPartLoadDataCollector.collect(this.context.manifest,this._perfTagName,this.context.pageContext),this._isLoggedRenderPerf=!0,h()||this.context._host.onRenderCompleted(this.instanceId,!0)),c.writeUnexpectedFailure("failedGetRenderArguments",e,Object(r.__assign)(Object(r.__assign)({},p),{alias:this.context.manifest.alias,deviceContext:this.context.deviceContext,instanceId:this.instanceId,isInternal:m()?void 0:this.manifest.isInternal||!1,manifestId:this.context.manifest.id,displayMode:b()?void 0:this.displayMode})),!g()&&this.manifest.isInternal&&this.displayMode===l.DisplayMode.Edit&&this.context._logEditCustomerPromiseFailure(this.manifest.alias,e.message,"AdaptiveCardExtensionGetRenderArgumentsFailed")}return this._ACRenderArgs},t.prototype._propertiesMetadata=function(){return this.propertiesMetadata},t.prototype._getPropertyPaneConfiguration=function(){return this.getPropertyPaneConfiguration()},Object.defineProperty(t.prototype,"navigator",{get:function(){return"Card"===this.renderType?this._cardNavigator:this._quickViewNavigator},enumerable:!1,configurable:!0}),t.prototype._internalDeserialize=function(e){e.title&&(this._title=e.title),e.iconProperty&&(this._iconProperty=e.iconProperty),e.description&&(this._description=e.description),e.cardSize&&(this._cardSize=e.cardSize);var t=e.properties;this.renderedFromPersistedData&&(o._PropertyMetadataProcessor.reInstateServerProcessedData(this.propertiesMetadata,t,e.serverProcessedContent),e.serverProcessedContent=void 0),this._properties?Object.assign(this._properties,t):this._properties=this.onAfterDeserialize(t,e.dataVersion?l.Version.parse(e.dataVersion):this.dataVersion),!h()&&this.isRenderAsync&&this._startRenderCompletedGuardTimer(),M()&&(this._cacheKey=this._generateCacheKey(e.dashboardWebPartInstanceId)),this._instanceIdForLogs=!v()&&e.instanceIdForLogs?e.instanceIdForLogs:e.instanceId},t.prototype._internalInitialize=function(t,n,a,i,r){var o=this;e.prototype._initializeContext.call(this,t),this._displayMode=a,this._renderedOnce=!1,this._renderedFromPersistedData=n,M()&&(this._cacheManager=new k(this.context,function(){return o.cardSize},function(){return o.iconProperty},function(){return o.title},this._onViewInitialized,this.getCacheSettings())),this._perfTagName=i,this._isInitializedWithLKG=r},t.prototype._internalSetDisplayMode=function(e){if(this._displayMode!==e){var t=this._displayMode;this._displayMode=e,this.onDisplayModeChanged(t)}},t.prototype._loadPropertyPaneResources=function(){return this.loadPropertyPaneResources()},t.prototype._onPropertyPaneFieldChanged=function(e,t,n){Object(x.isEqual)(t,n)||(this._updateProperty(e,n),this.onPropertyPaneFieldChanged(e,t,n))},t.prototype._renderCompleted=function(){this._renderedOnce=!0},t.prototype._internalOnAfterInit=function(){this._isInitialized=!0,!h()&&this.isRenderAsync&&(this._lkgRenderTime=u._PerformanceLogger.now())},t.prototype._internalSerialize=function(){return this.onBeforeSerialize(),{dataVersion:this.dataVersion.toString(),id:this.componentId,instanceId:this.instanceId,properties:this.properties,title:this.title,description:this._description,iconProperty:this.iconProperty,cardSize:this._cardSize}},t.prototype._setRenderType=function(e,t){if(this._renderType!==e){var n=this._renderType;"QuickView"===n&&this._quickViewNavigator._clear(),"Card"===n&&(this._quickViewNavigator._clear(),void 0!==t&&this._quickViewNavigator.push(t,!0)),this._renderType=e,this.onRenderTypeChanged(n)}},t.prototype._updateConfigurableFields=function(e,t){"cardSize"===e&&(this._cardSize=t)},t.prototype._logCardActionEngagement=function(e,t,n,i){var r,o,s,c,d,u,f,p,m,_;a._EngagementLogger.log({name:"AdaptiveCardExtension.CardAction",isIntentional:!0,siteId:null===(o=null===(r=this.context.pageContext)||void 0===r?void 0:r.site)||void 0===o?void 0:o.id.toString(),webId:null===(c=null===(s=this.context.pageContext)||void 0===s?void 0:s.web)||void 0===c?void 0:c.id.toString(),extraData:{actionType:e,alias:this.manifest.alias,cardSize:this.cardSize,componentDeveloperName:this.manifest.componentDeveloperName,correlationId:null===(d=this.context.pageContext.site.correlationId)||void 0===d?void 0:d.toString(),deviceContext:this.context.deviceContext,eventSchemaVersion:10,isInternal:this.manifest.isInternal||!1,instanceId:this._instanceIdForLogs,listId:this._urlParams.get("dashboardListID")?this._urlParams.get("dashboardListID"):null===(u=this.context.pageContext.list)||void 0===u?void 0:u.id.toString(),listItemUniqueId:this._urlParams.get("id")?this._urlParams.get("id"):null===(f=this.context.pageContext.listItem)||void 0===f?void 0:f.id,manifestId:this.manifest.id,mobileSessionId:n,mobileBootType:i,mpnId:this.manifest.mpnId,renderType:l._SPKillSwitch.isActivated("6d5c9ddb-5bc7-4b59-bbdf-ff9052d33daf")||"QuickView"!==e?this.renderType:"Card",tenantId:null===(_=null===(m=null===(p=this.context.pageContext)||void 0===p?void 0:p.aadInfo)||void 0===m?void 0:m.tenantId)||void 0===_?void 0:_.toString().toLowerCase(),vivaConnectionsAppId:"d2c6f111-ffad-42a0-b65e-ee00425598aa",vivaConnectionsName:"MEE",workLoad:t}})},t.prototype._getQuickView=function(e){if(0!==this._quickViewNavigator.size){var t=this._quickViewNavigator._currentView;if(void 0!==t)return A(t.externalLink,this.context.deviceContext),{data:t.data,template:e?this._ACRenderArgs.quickLook.template:t.template,pageBarProperties:{externalLink:t.externalLink,leftNavigationButtonType:this._quickViewNavigator.size>1?"Back":"Close",title:t.title},viewId:this._quickViewNavigator.currentId,viewStackSize:this._quickViewNavigator.size}}},t.prototype._updateRenderArgs=function(e,t){this._ACRenderArgs.lastUpdatedType=e,this._ACRenderArgs.isVisible=this._isVisible,"Card"===e?this._ACRenderArgs.card=this._getCard(t):this._ACRenderArgs.quickLook=this._getQuickView(t)},t.prototype._updateProperty=function(e,t){Object(x.update)(this._properties,e,function(){return t})},t.prototype._startRenderCompletedGuardTimer=function(){var e=this;this._renderCompletedPromise=new Promise(function(t,n){e._renderCompletedPromiseResolver=t,e._renderCompletedPromiseRejector=n}),this._renderCompletedGuardTimer=window.setTimeout(function(){e._renderCompletedPromiseRejector()},15e3),this._resolveRenderCompleted()},t.prototype._clearRenderCompletedGuardTimer=function(){this._renderCompletedGuardTimer&&(window.clearTimeout(this._renderCompletedGuardTimer),this._renderCompletedGuardTimer=void 0,this._renderCompletedPromiseResolver=void 0,this._renderCompletedPromiseRejector=void 0,this._renderCompletedPromise=void 0)},t.prototype._generateCacheKey=function(e){var t;return!l._SPFlight.isEnabled(60399)||"Mobile"===this.context.deviceContext||this.context.manifest.isolatedDomain?ne.getKey(this.context.pageContext.site.id.toString(),null===(t=this.context.pageContext.listItem)||void 0===t?void 0:t.uniqueId):null!=e?e:this.instanceId},t}(o.BaseComponent);!function(e){e[e.Image=1]="Image",e[e.Audio=4]="Audio"}(P||(P={}));var ie=n("2SXB"),re=n("X+PM"),oe=function(){function e(e){var t=this;this._serviceScope=e,this._callbackCache=new Map,this._isolatedFrames=new Map,this._isolatedListeners=new Map,this._handleIframeTimeout=function(e,n){var i=t._isolatedFrames.get(e),r=i.frameMonitor,o=i.retryMonitor,s=i.tokenMonitor;if(!p()&&i.retryCount<1)return i.retryCount+=1,i.iframe.src=i.iframe.src,i.retryMonitor=new a._QosMonitor("IsolatedAdaptiveCardExtension.iframeReload"),void(i.timeoutId=setTimeout(function(){return t._handleIframeTimeout(e,n)},14500));if(o&&o.writeUnexpectedFailure("reloadFailed"),r&&!r.hasEnded)try{s?(r.writeUnexpectedFailure("tokenTimeout"),s.hasEnded||s.writeUnexpectedFailure("timeout")):n?r.writeUnexpectedFailure("authorizeTimeout"):r.writeExpectedFailure("authorizeTimeout")}catch(e){r.writeUnexpectedFailure("unexpectedFailure",e)}},this._handleIsolatedApplicationMessage=function(e){var n=e.data;if("applicationMessage"===n.messageType){var i=n.instanceId,r=n.kind;switch(r){case"Card":t._invokeCallback(i,{aceData:n.aceData,card:n.card,cacheObject:n.cacheObject,type:r});break;case"CloseQuickView":var o=t._isolatedFrames.get(new URL(e.origin).hostname);o&&(o.iframe.hidden=!0);break;case"Error":t._invokeCallback(i,{error:n.error,type:r});break;case"OpenQuickView":var s=t._isolatedFrames.get(new URL(e.origin).hostname);s&&(s.iframe.hidden=!1);break;case"OpenUrl":t._invokeCallback(i,{type:r,url:n.url});break;case"LocationRequest":t._invokeCallback(i,{type:r});break;case"RenderCompleted":t._invokeCallback(i,{type:r,didUpdate:n.didUpdate});break;case"Ready":var c=t._isolatedFrames.get(new URL(e.origin).hostname);if(c){!p()&&c.retryMonitor&&c.retryMonitor.writeSuccess(),f()||(clearTimeout(c.timeoutId),c.frameMonitor.writeSuccess()),c.isReady=!0;for(var d=0,l=c.messageQueue;d<l.length;d++){var u=l[d],m=u[0],_=u[1];t._sendMessage(t._getIsolatedFrame(m),m,_)}c.messageQueue=[]}break;case"OBOTokenRequest":var h=n.applicationId,b=n.claims;t._getAuthToken(h,b,e.origin);break;default:t._logError("Unexpected message: ".concat(JSON.stringify(e.data)))}}else if("bridgeMessage"===n.messageType&&"onTokenRequested"===n.bridgeAction){var g=f(),v=g?void 0:new a._QosMonitor("IsolatedAdaptiveCardExtensionService.onTokenRequested"),y=(h=n.applicationId,b=n.claims,t._isolatedFrames.get(new URL(e.origin).hostname));if(!g&&!y)return void v.writeUnexpectedFailure("missingIsolatedFrame");y.tokenMonitor=v;var S=ie._AadTokenProviders.configurable;if(!g&&!S._oboThirdPartyTokenCallback)return void v.writeUnexpectedFailure("missingThirdPartyTokenCallback");try{S._oboThirdPartyTokenCallback(h,b).then(function(e){if(!g&&!y.iframe.contentWindow)throw new Error("missingContentWindow");y.iframe.contentWindow.postMessage({token:e,messageType:"dashboardMessage",kind:"Token"},"*"),g||v.writeSuccess()}).catch(function(e){g||v.writeUnexpectedFailure("oboThirdPartyTokenCallbackError",e)})}catch(e){g||v.writeUnexpectedFailure("unexpectedException",e)}}},window.addEventListener("message",this._handleIsolatedApplicationMessage)}return Object.defineProperty(e.prototype,"_pageContext",{get:function(){return this._pContext||(this._pContext=this._serviceScope.consume(re.PageContext.serviceKey)),this._pContext},enumerable:!1,configurable:!0}),e.prototype.disposeEntry=function(e){this._isolatedListeners.delete(e)},e.prototype.load=function(e){var t=this,n=e.callback,i=e.dashboardListId,r=e.itemId,s=e.instanceId,c=e.listenerId,d=e.manifestId,m=e.serviceDestinationEndpoint,h=e.botId,b=e.isolatedDomain.toLowerCase(),g=this._isolatedFrames.get(b);if(!g){var v=f(),y=v?void 0:new a._QosMonitor("IsolatedAdaptiveCardExtensionService.load"),S=document.createElement("iframe"),D=this._pageContext.site.serverRelativeUrl,I="/"===D?"":D,x=new URLSearchParams(window.location.search);x.append("dashboardListID",i),x.append("id",r),1===u._SPPerfExperiment.getVariantAndTrackExperiment(u._PerformanceExperiment.WEXOOPIF)&&x.append("OOPIF","1"),(_()||h)&&x.append("instanceId",s),l._SPKillSwitch.isActivated("af73304b-993c-47ab-b941-fae5c9224d19")||x.append("deviceContext",l._BrowserUtilities.isTeams1PVivaDesktopHosted()?"TeamsDesktop":"WebView");var C=_()||void 0===m?"adaptivecardextensions.aspx":m,O="/_layouts/15/".concat(C,"?").concat(x.toString()),w=Object(o._ensureIsolatedDomainUrl)(b,this._pageContext.web.absoluteUrl),E=l._BrowserUtilities.isTeams1PVivaDesktopHosted();!l._SPKillSwitch.isActivated("bcdde4d5-f091-4249-8944-c9e490c7d226")&&l._BrowserUtilities.isUsingSecureBroker()?S.src="".concat(w,"/_layouts/15/brokerlogon.aspx?spfx=true&").concat(l._BROKER_IN_USE_KEY,"=true&dest=").concat(encodeURIComponent(w+O)):E&&l._SPFlight.isEnabled(60128)?S.src="".concat(w,"/_layouts/15/framedteamslogon.aspx?spfx=true&dest=").concat(encodeURIComponent(I+O)):S.src=w+O,S.hidden=!0,S.scrolling="no",S.style.overflow="hidden",S.style.height="100%",S.style.width="100%",S.style.top="0",S.style.left="0",S.style.position="fixed",S.style.zIndex="99999",S.style.border="none",l._SPKillSwitch.isActivated("bc68fda3-34d5-496b-8515-8d140a0c98ac")||S.setAttribute("allow","geolocation"),S.setAttribute("data-automation-id","isolated_ACE_iframe"),document.body.appendChild(S);var A=b.toLowerCase();g={iframe:S,frameMonitor:y,isReady:!1,messageQueue:[],retryCount:0},p()?v||(g.timeoutId=setTimeout(function(){if(y&&!y.hasEnded){var e=t._isolatedFrames.get(A);try{e.tokenMonitor?(y.writeUnexpectedFailure("tokenTimeout"),e.tokenMonitor.hasEnded||e.tokenMonitor.writeUnexpectedFailure("timeout")):E?y.writeUnexpectedFailure("authorizeTimeout"):y.writeExpectedFailure("authorizeTimeout")}catch(e){y.writeUnexpectedFailure("unexpectedFailure",e)}}},15e3)):g.timeoutId=setTimeout(function(){return t._handleIframeTimeout(A,E)},15e3),this._isolatedFrames.set(A,g)}var L=this._isolatedListeners.get(s);if(L)L.listeners.get(c)||L.listeners.set(c,{callback:n});else{var k={isolatedDomain:b,iframe:g.iframe,listeners:new Map([[c,{callback:n}]]),manifestId:d};h&&(k.botId=h),this._isolatedListeners.set(s,k)}e.isRenderedFromPersistedData||this.sendInitialize(s,d);var M=this._callbackCache.get(s);M&&this._invokeCallback(s,M,c)},e.prototype.renderQuickView=function(e){var t=e.instanceId,n=e.isSelectAction,a=e.listenerId,i=e.pageTheme,r=e.targetRect,o=e.theme,s=e.viewId;this._sendMessage(this._getIsolatedFrame(t),t,{serviceAction:"Action",action:{action:{type:"QuickView",isSelectAction:n,pageTheme:i,targetRect:r,theme:o,viewId:s},instanceId:t,listenerId:a}})},e.prototype.setDisplayMode=function(e){},e.prototype.setRenderType=function(e){},e.prototype.sendAction=function(e){var t=e.instanceId;this._sendMessage(this._getIsolatedFrame(t),t,{serviceAction:"Action",action:e})},e.prototype.sendInitialize=function(e,t){this._sendMessage(this._getIsolatedFrame(e),e,{serviceAction:"Initialize",newInstanceId:e,manifestId:t})},e.prototype.updateACEData=function(e,t){this._isolatedListeners.has(e)&&this._sendMessage(this._getIsolatedFrame(e),e,{aceData:t,instanceId:e,serviceAction:"UpdateACEData"})},e.prototype.handleLocationRequest=function(e,t,n){this._sendMessage(this._getIsolatedFrame(e),e,{location:t,locationError:n,instanceId:e,serviceAction:"LocationResponse"})},e.prototype._invokeCallback=function(e,t,n){var a,i=this._isolatedListeners.get(e);this._callbackCache.set(e,t),i?n?null===(a=i.listeners.get(n))||void 0===a||a.callback(t):i.listeners.forEach(function(e){return e.callback(t)}):this._logError("No entry for ".concat(e))},e.prototype._logError=function(t){a._TraceLogger.logError(e._logSource,new Error(t))},e.prototype._getAuthToken=function(e,t,n){var i=this,r=new a._QosMonitor("IsolatedAdaptiveCardExtensionService._getAuthToken"),o=ie._AadTokenProviders.configurable;if(!o._oboThirdPartyTokenCallback)return r.writeUnexpectedFailure("oboThirdPartTokenCallbackUndefined"),void this._logError("Unexpected message: oboThirdPartyTokenCallback is not defined.");o._oboThirdPartyTokenCallback(e,t).then(function(t){var a=new URL(n),o=i._isolatedFrames.get(a.hostname);i._sendMessage(o,"",{token:t,applicationId:e,serviceAction:"OBOToken"}),r.writeSuccess()}).catch(function(e){r.writeUnexpectedFailure("oboThirdPartTokenCallbackFailure"),i._logError("Unexpected message: ".concat(JSON.stringify(e)))})},e.prototype._getIsolatedFrame=function(e){var t=this._isolatedListeners.get(e);return t?this._isolatedFrames.get(t.isolatedDomain):void 0},e.prototype._postOrQueueMessage=function(e,t,n){e.isReady?(t.messageType="serviceMessage",e.iframe.contentWindow.postMessage(t,"*")):e.messageQueue.push([n,t])},e.prototype._sendMessage=function(e,t,n){e?this._postOrQueueMessage(e,n,t):this._logError("No entry for ".concat(t))},e.serviceKey=l.ServiceKey.create("sp-adaptive-card-extension-base::IsolatedAdaptiveCardExtensionService",e),e._logSource={id:"IsolatedAdaptiveCardExtensionService"},e}(),se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._templateType="Image",t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"template",{get:function(){return this._getTemplate(B,z)},enumerable:!1,configurable:!0}),t}(W),ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._templateType="PrimaryText",t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"template",{get:function(){return this._getTemplate(j,G)},enumerable:!1,configurable:!0}),t}(W),de=function(e){function t(t){var n=e.call(this)||this;return n._serviceScope=t,n._cacheEntries={},n._cacheProvider=n._serviceScope.consume(Object(ie._getCacheDataProviderServiceKey)())._provider,n._providerPromises=new Map,n}return Object(r.__extends)(t,e),t.instance=function(e){return t._instance||(t._instance=new t(e)),t._instance},t.prototype.save=function(e,t,n){var i,r=new a._QosMonitor("ACEMySiteCache.save"),o={key:e};if(!this._cacheEntries[e]){var s=((i={})[t]=n,i);this._cacheEntries[e]=s}this._cacheEntries[e][t]=n,this._cacheProvider.setData(o,this._cacheEntries[e],this._getCacheConfig(e)).then(function(e){if(e)return r.writeSuccess({isDataSaved:e}),Promise.resolve();r.writeUnexpectedFailure("dataIsNotSaved")}).catch(function(e){r.writeUnexpectedFailure("mySiteCacheSetDataFailed",e)})},t.prototype.get=function(t,n){return e.prototype.get.call(this,t,n)},t.prototype.getFromSource=function(e,t){var n=this,i=new a._QosMonitor("ACEMySiteCache.getFromSource"),r={key:e},o=this._providerPromises.get(e);return o||(o=this._cacheProvider.getData(r,this._getCacheConfig(e)).then(function(e){return i.writeSuccess(),e.data}).then(function(t){n._populateLocalCache(e,t)}).catch(function(t){return n._providerPromises.delete(e),i.writeUnexpectedFailure("mySiteCacheGetDataFailed",t),Promise.reject(t)}),this._providerPromises.set(e,o)),o.then(function(){return n._cacheEntries[e]?n._cacheEntries[e][t]:void 0})},t.prototype._populateLocalCache=function(e,t){var n=Object.keys(t),a={};n.forEach(function(e){a[e]=t[e]}),this._cacheEntries[e]=a},t.prototype._getCacheConfig=function(e){return{cacheStrategy:ie._CacheStrategy.CacheAndNetwork,expirationDuration:k.CACHE_EXPIRATION_TIME,id:e,alias:"ACEMySiteCacheManager",extraProps:t._cacheExtraProps}},t._cacheExtraProps=new Map([["onlyMySiteCache",!0]]),t}(te)},ut3N:function(e,t){e.exports=l}})});